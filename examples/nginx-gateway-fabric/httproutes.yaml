# HTTPRoute 1: Exact path routing
# /api/get -> httpbin /get
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: httpbin-get
spec:
  parentRefs:
    - name: ngf-gateway
  hostnames:
    - "httpbin.example.com"
  rules:
    - matches:
        - path:
            type: Exact
            value: /api/get
      filters:
        - type: URLRewrite
          urlRewrite:
            path:
              type: ReplaceFullPath
              replaceFullPath: /get
      backendRefs:
        - name: httpbin
          port: 80
---
# HTTPRoute 2: Path prefix matching
# /api/anything/* -> httpbin /anything/*
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: httpbin-anything
spec:
  parentRefs:
    - name: ngf-gateway
  hostnames:
    - "httpbin.example.com"
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /api/anything
      filters:
        - type: URLRewrite
          urlRewrite:
            path:
              type: ReplacePrefixMatch
              replacePrefixMatch: /anything
      backendRefs:
        - name: httpbin
          port: 80
---
# HTTPRoute 3: Header-based routing
# Requests with X-Test-Route: canary -> httpbin /headers
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: httpbin-header-canary
spec:
  parentRefs:
    - name: ngf-gateway
  hostnames:
    - "httpbin.example.com"
  rules:
    - matches:
        - headers:
            - name: X-Test-Route
              value: canary
          path:
            type: PathPrefix
            value: /api
      filters:
        - type: URLRewrite
          urlRewrite:
            path:
              type: ReplacePrefixMatch
              replacePrefixMatch: /headers
      backendRefs:
        - name: httpbin
          port: 80
